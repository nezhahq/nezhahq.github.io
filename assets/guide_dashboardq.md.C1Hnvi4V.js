import{_ as a,c as s,o as i,a4 as e}from"./chunks/framework.BmdFiWrL.js";const b=JSON.parse('{"title":"Dashboard 常见问题","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/dashboardq.md","filePath":"guide/dashboardq.md","lastUpdated":1756917506000}'),n={name:"guide/dashboardq.md"},t=e(`<h1 id="dashboard-常见问题" tabindex="-1">Dashboard 常见问题 <a class="header-anchor" href="#dashboard-常见问题" aria-label="Permalink to &quot;Dashboard 常见问题&quot;">​</a></h1><hr><h2 id="为什么管理面板中显示的-ip-和-agent-实际-ip-不一致" tabindex="-1">为什么管理面板中显示的 IP 和 Agent 实际 IP 不一致？ <a class="header-anchor" href="#为什么管理面板中显示的-ip-和-agent-实际-ip-不一致" aria-label="Permalink to &quot;为什么管理面板中显示的 IP 和 Agent 实际 IP 不一致？&quot;">​</a></h2><p>管理面板中显示的 IP 是 Agent 使用 <a href="https://github.com/nezhahq/agent/blob/main/pkg/monitor/myip.go" target="_blank" rel="noreferrer">IP-API</a> 检测并上报的出口 IP。<br> 如显示的 IP 与服务商提供的 IP 不一致，可能原因如下：</p><ol><li><strong>服务商使用入口 IP</strong>：服务商提供的 IP 为高防或映射后的入口 IP，而非实际出口 IP。</li><li><strong>多线路或专线环境</strong>：多线服务器或 IPLC 专线可能导致出口 IP 与预期不一致。</li></ol><h3 id="验证出口-ip" tabindex="-1">验证出口 IP <a class="header-anchor" href="#验证出口-ip" aria-label="Permalink to &quot;验证出口 IP&quot;">​</a></h3><p>在 Agent 服务器中运行以下命令测试出口 IP：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://ipapi.co/ip/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ip.sb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ip-api.com</span></span></code></pre></div><hr><h2 id="面板安装-重启-更新失败-iptables" tabindex="-1">面板安装/重启/更新失败：<code>iptables ......</code> <a class="header-anchor" href="#面板安装-重启-更新失败-iptables" aria-label="Permalink to &quot;面板安装/重启/更新失败：\`iptables ......\`&quot;">​</a></h2><ol><li><p><strong>重启 Docker</strong> 运行以下命令重启 Docker：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div></li><li><p><strong>关闭或移除 iptables</strong> 若问题仍未解决，尝试关闭或移除 <code>iptables</code>。</p></li><li><p><strong>更换官方内核</strong> 部分问题可能与内核有关，切换到官方内核后再尝试操作。</p></li></ol><hr><h2 id="面板布局错误、css-资源无法被加载" tabindex="-1">面板布局错误、CSS 资源无法被加载 <a class="header-anchor" href="#面板布局错误、css-资源无法被加载" aria-label="Permalink to &quot;面板布局错误、CSS 资源无法被加载&quot;">​</a></h2><p>通常由 CSS 文件丢失或无法加载导致。解决方法如下：</p><ol><li><p><strong>重启并更新面板</strong><br> 执行一键脚本选择 <code>更新面板</code>。</p></li><li><p><strong>检查 Nginx 配置</strong><br> 若问题未解决，检查并修改 Nginx 的 vhost 文件：</p><ul><li>在宝塔面板中找到安装 Dashboard 时配置的站点，点击 <strong><code>设置</code> → <code>配置文件</code></strong>。</li><li>删除以下内容：<div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">location</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> .*\\.(js|css)?$</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        expires </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     12h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/dev/null;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        access_log </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/dev/null;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre></div></li><li>保存配置，并清空浏览器、Nginx 和 CDN 的缓存。</li></ul></li><li><p><strong>刷新页面</strong><br> 此时页面应恢复正常。</p></li></ol><hr><h2 id="面板无法启动-panic-无法找到配置的-ddns-提供者" tabindex="-1">面板无法启动：<code>panic：无法找到配置的 DDNS 提供者...</code> <a class="header-anchor" href="#面板无法启动-panic-无法找到配置的-ddns-提供者" aria-label="Permalink to &quot;面板无法启动：\`panic：无法找到配置的 DDNS 提供者...\`&quot;">​</a></h2><p>DDNS 提供者配置错误。支持的值包括：<code>webhook</code>、<code>cloudflare</code>、<code>tencentcloud</code> 和 <code>dummy</code>。请确认配置正确。</p><hr><h2 id="面板更新-ddns-崩溃-panic-interface-conversion-interface-is-nil-not-interface" tabindex="-1">面板更新 DDNS 崩溃：<code>panic：interface conversion: interface {} is nil, not []interface {}</code> <a class="header-anchor" href="#面板更新-ddns-崩溃-panic-interface-conversion-interface-is-nil-not-interface" aria-label="Permalink to &quot;面板更新 DDNS 崩溃：\`panic：interface conversion: interface {} is nil, not []interface {}\`&quot;">​</a></h2><p>DDNS <code>AccessID</code> 或 <code>AccessSecret</code> 填写有误，请检查并更正。</p><hr><h2 id="面板警告-nezha-错误的服务监控上报" tabindex="-1">面板警告：<code>NEZHA&gt;&gt; 错误的服务监控上报...</code> <a class="header-anchor" href="#面板警告-nezha-错误的服务监控上报" aria-label="Permalink to &quot;面板警告：\`NEZHA&gt;&gt; 错误的服务监控上报...\`&quot;">​</a></h2><p>此问题通常由于 Dashboard 和 Agent 的版本不匹配导致。<br> 解决方法：更新 Dashboard 和 Agent 至最新版本。</p><hr><h2 id="服务器网络监控页显示空白" tabindex="-1">服务器网络监控页显示空白 <a class="header-anchor" href="#服务器网络监控页显示空白" aria-label="Permalink to &quot;服务器网络监控页显示空白&quot;">​</a></h2><p>此错误说明：</p><ol><li>未在服务页中设置 <code>TCP-Ping</code> 或 <code>ICMP-Ping</code> 类型的监控。</li><li>数据尚未生成。<br> 解决方法：完成设置后等待一段时间，再查看监控数据。</li></ol><hr><h2 id="启用-https-后-terminal-或-ws-无法正常连接" tabindex="-1">启用 HTTPS 后 <code>/terminal</code> 或 <code>/ws</code> 无法正常连接 <a class="header-anchor" href="#启用-https-后-terminal-或-ws-无法正常连接" aria-label="Permalink to &quot;启用 HTTPS 后 \`/terminal\` 或 \`/ws\` 无法正常连接&quot;">​</a></h2><p>此问题多因证书不完整导致：</p><ol><li>查看日志是否出现：<div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>x509:certificate signed by unknown authority</span></span></code></pre></div></li><li>若有该错误，更换完整证书即可解决。</li></ol><hr><h2 id="数据修改-功能扩展需求" tabindex="-1">数据修改/功能扩展需求 <a class="header-anchor" href="#数据修改-功能扩展需求" aria-label="Permalink to &quot;数据修改/功能扩展需求&quot;">​</a></h2><p>若需对 Dashboard 提供的数据进行修改（如批量新建 Agent），可直接操作数据库。</p><h3 id="注意事项" tabindex="-1">注意事项： <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项：&quot;">​</a></h3><ul><li>数据库类型为 <code>sqlite3</code>，位于 <code>/opt/nezha/dashboard/data/sqlite.db</code>。</li><li>修改数据前，请备份数据库。</li><li>修改时，务必 <strong>停止面板容器</strong>。</li></ul><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>请勿随意修改数据库！错误修改可能导致数据混乱或无法启动 Dashboard。</p></div><hr><h2 id="dashboard-是否会自动更新" tabindex="-1">Dashboard 是否会自动更新？ <a class="header-anchor" href="#dashboard-是否会自动更新" aria-label="Permalink to &quot;Dashboard 是否会自动更新？&quot;">​</a></h2><p>Dashboard 不会自动更新，需要手动运行脚本进行更新。<br> Agent 在默认情况下会自动更新。</p><hr><h2 id="连接在线终端时提示-agent-信令下发失败" tabindex="-1">连接在线终端时提示：<code>Agent 信令下发失败</code> <a class="header-anchor" href="#连接在线终端时提示-agent-信令下发失败" aria-label="Permalink to &quot;连接在线终端时提示：\`Agent 信令下发失败\`&quot;">​</a></h2><p>此问题可能由于以下原因导致：</p><ol><li><strong>Agent 离线</strong>：检查 Agent 是否正常运行。</li><li><strong>连接不稳定</strong>：确认 Agent 与 Dashboard 的连接是否稳定，并排除网络问题。</li></ol><hr><h2 id="复制安装命令时提示-you-have-not-specify-the-installed-host" tabindex="-1">复制安装命令时提示：<code>You have not specify the installed host.</code> <a class="header-anchor" href="#复制安装命令时提示-you-have-not-specify-the-installed-host" aria-label="Permalink to &quot;复制安装命令时提示：\`You have not specify the installed host.\`&quot;">​</a></h2><h3 id="错误原因" tabindex="-1">错误原因 <a class="header-anchor" href="#错误原因" aria-label="Permalink to &quot;错误原因&quot;">​</a></h3><p>此错误表示您尚未在设置页面中配置 <strong><code>仪表板服务器域名/IP（无 CDN）</code></strong>。<br> 该项配置是生成安装命令的必要条件，未配置时无法正确生成安装命令。</p><hr><h3 id="解决方法" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法" aria-label="Permalink to &quot;解决方法&quot;">​</a></h3><ol><li><p><strong>进入设置页面</strong><br> 登录 Dashboard，点击右上角头像，选择 <strong><code>系统设置</code></strong>。</p></li><li><p><strong>配置服务器域名/IP</strong><br> 在 <strong><code>仪表板服务器域名/IP（无 CDN）</code></strong> 项中填写您的服务器域名或 IP 地址。<br> 示例：</p><ul><li><strong>域名</strong>：<code>data.example.com</code></li><li><strong>IP</strong>：<code>123.123.123.123</code></li></ul></li><li><p><strong>保存设置</strong><br> 完成配置后，保存设置并返回安装命令页面，重新复制安装命令。</p></li></ol><hr><h2 id="file-manager-下载-上传时卡住" tabindex="-1">File Manager 下载/上传时卡住 <a class="header-anchor" href="#file-manager-下载-上传时卡住" aria-label="Permalink to &quot;File Manager 下载/上传时卡住&quot;">​</a></h2><h3 id="问题原因" tabindex="-1">问题原因 <a class="header-anchor" href="#问题原因" aria-label="Permalink to &quot;问题原因&quot;">​</a></h3><ol><li><p><strong>缓冲区设置问题</strong><br> File Manager (FM) 在传输文件时，每次发送的数据块大小为 <strong>1 MiB</strong>。如果代理的缓冲区小于 1 MiB，可能会导致传输卡住。</p></li><li><p><strong>CDN 影响性能</strong><br> 使用 CDN 可能会严重降低文件传输性能，甚至导致卡顿。</p></li></ol><h3 id="解决方法-1" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法-1" aria-label="Permalink to &quot;解决方法&quot;">​</a></h3><h4 id="_1-检查并调整代理缓冲区" tabindex="-1">1. 检查并调整代理缓冲区 <a class="header-anchor" href="#_1-检查并调整代理缓冲区" aria-label="Permalink to &quot;1. 检查并调整代理缓冲区&quot;">​</a></h4><p>对于常见的代理服务器（如 Nginx 和 Caddy），确保其缓冲区大于 1 MiB：</p><p><strong>Nginx 配置示例</strong>：</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">proxy_buffer_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">proxy_buffers </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">proxy_busy_buffers_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><ul><li>将以上配置添加到 Nginx 的站点配置中，保存后重新加载配置：<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reload</span></span></code></pre></div></li></ul><p><strong>Caddy 配置示例</strong>：</p><div class="language-caddy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">caddy</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>reverse_proxy {</span></span>
<span class="line"><span>    transport http {</span></span>
<span class="line"><span>        read_buffer 2MB</span></span>
<span class="line"><span>        write_buffer 2MB</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><ul><li>将缓冲区大小设置为至少 2 MiB，保存配置并重启 Caddy 服务。</li></ul><h4 id="_2-尝试直接连接" tabindex="-1">2. 尝试直接连接 <a class="header-anchor" href="#_2-尝试直接连接" aria-label="Permalink to &quot;2. 尝试直接连接&quot;">​</a></h4><p>如果使用 CDN，建议绕过 CDN，直接连接到源服务器进行文件传输。<br> 检查连接方式是否直接指向源服务器的 IP 或域名，并确保网络畅通。</p><hr><h2 id="使用-nginx-反代-grpc-无法连接-agent" tabindex="-1">使用 Nginx 反代 gRPC 无法连接 Agent <a class="header-anchor" href="#使用-nginx-反代-grpc-无法连接-agent" aria-label="Permalink to &quot;使用 Nginx 反代 gRPC 无法连接 Agent&quot;">​</a></h2><h3 id="问题原因-1" tabindex="-1">问题原因 <a class="header-anchor" href="#问题原因-1" aria-label="Permalink to &quot;问题原因&quot;">​</a></h3><p>Nginx 默认不允许 Header 中含有下划线，而 Agent 使用 <code>client_secret</code> 与 <code>client_uuid</code> 进行认证。</p><h3 id="解决方法-2" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法-2" aria-label="Permalink to &quot;解决方法&quot;">​</a></h3><ol><li><strong>允许下划线</strong></li></ol><p>在 server 块中添加 <code>underscores_in_headers on;</code>。</p><ol start="2"><li><strong>手动发送 Header</strong></li></ol><p>在 server 块中添加 <code>ignore_invalid_headers off;</code>，之后在 gRPC 反代选项中加入：</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">grpc_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">client_secret $http_client_secret;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">grpc_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">client_uuid $http_client_uuid;</span></span></code></pre></div>`,77),l=[t];function o(r,h,p,d,c,g){return i(),s("div",null,l)}const u=a(n,[["render",o]]);export{b as __pageData,u as default};
