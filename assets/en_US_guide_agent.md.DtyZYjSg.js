import{_ as s,c as i,o as a,a4 as e}from"./chunks/framework.BmdFiWrL.js";const u=JSON.parse('{"title":"Installing the Agent","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"en_US/guide/agent.md","filePath":"en_US/guide/agent.md","lastUpdated":1740049627000}'),n={name:"en_US/guide/agent.md"},t=e(`<h1 id="installing-the-agent" tabindex="-1">Installing the Agent <a class="header-anchor" href="#installing-the-agent" aria-label="Permalink to &quot;Installing the Agent&quot;">​</a></h1><p><strong>The client-side service of Nezha Monitoring is called the Agent. This document will guide you on how to install the Agent on the client server and connect it to the Dashboard.</strong></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The binary repository for the Agent is available at: <a href="https://github.com/nezhahq/agent/releases" target="_blank" rel="noreferrer">https://github.com/nezhahq/agent/releases</a></p></div><h2 id="one-click-installation-of-the-agent" tabindex="-1">One-click Installation of the Agent <a class="header-anchor" href="#one-click-installation-of-the-agent" aria-label="Permalink to &quot;One-click Installation of the Agent&quot;">​</a></h2><p>Nezha Monitoring supports one-click installation of the Agent on Windows, macOS, and Linux. By following the steps in this document, you can easily deploy it on your server.</p><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><p>Before installation, you need to set up a communication domain in the Dashboard Admin Panel. It is not recommended to route this domain through a CDN. This document uses the example communication domains &quot;data.example.com&quot;.</p><ol><li>In the Dashboard Admin Panel, click on your avatar to navigate to the <strong>System Settings</strong> page.</li><li>In the <strong>Agent Connection Address [Domain/IP:Port]</strong> field, enter the communication domain and port, e.g., <code>data.example.com:8008</code>.</li><li>Click <strong>Confirm</strong> to save the settings.</li></ol><h3 id="one-click-installation-steps" tabindex="-1">One-click Installation Steps <a class="header-anchor" href="#one-click-installation-steps" aria-label="Permalink to &quot;One-click Installation Steps&quot;">​</a></h3><ol><li>On the <strong>Servers</strong> page, click <strong>Install Command</strong> and select your corresponding operating system. The installation command will be automatically copied to your clipboard.</li><li>Run the installation command on the client server. After the installation completes, return to the <strong>Servers</strong> page to check if the Agent has come online.</li><li>If the installation is successful, a new server will automatically appear on the page. You can click the <strong>Edit</strong> button to assign a name to it.</li></ol><h3 id="platform-specific-instructions" tabindex="-1">Platform-specific Instructions <a class="header-anchor" href="#platform-specific-instructions" aria-label="Permalink to &quot;Platform-specific Instructions&quot;">​</a></h3><h4 id="windows-specific-instructions" tabindex="-1">Windows Specific Instructions <a class="header-anchor" href="#windows-specific-instructions" aria-label="Permalink to &quot;Windows Specific Instructions&quot;">​</a></h4><ol><li>On the Windows server, open PowerShell.</li><li>Paste and run the installation command in PowerShell.</li><li>If prompted with an <strong>&quot;Execution Policy Change&quot;</strong> confirmation, type <code>Y</code> and press Enter.</li></ol><h2 id="alternative-methods-to-install-the-agent" tabindex="-1">Alternative Methods to Install the Agent <a class="header-anchor" href="#alternative-methods-to-install-the-agent" aria-label="Permalink to &quot;Alternative Methods to Install the Agent&quot;">​</a></h2><hr><h3 id="installing-the-agent-on-synology-dsm-7" tabindex="-1">Installing the Agent on Synology DSM 7 <a class="header-anchor" href="#installing-the-agent-on-synology-dsm-7" aria-label="Permalink to &quot;Installing the Agent on Synology DSM 7&quot;">​</a></h3><details><summary>Click to Expand/Collapse</summary><p>Since Synology NAS devices are based on specific versions of Linux, their shell environments and package managers differ from standard Linux systems, making one-click installation scripts unsupported. Therefore, you need to manually install the Agent by following these steps:</p><hr><h4 id="_1-preparation" tabindex="-1">1. Preparation <a class="header-anchor" href="#_1-preparation" aria-label="Permalink to &quot;1. Preparation&quot;">​</a></h4><ol><li><p><strong>Ensure Administrator Privileges</strong></p><ul><li>Log in to the Synology management interface or SSH into the device using an administrator account.</li></ul></li><li><p><strong>Install Necessary Dependencies</strong><br> Ensure that your Synology device has <code>wget</code>, <code>unzip</code>, or <code>curl</code> installed.</p></li></ol><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Alternatively, you can download and extract the Nezha Agent binaries in advance and manually upload them via Synology&#39;s DSM File Station, bypassing the need to install dependencies.</p></div><hr><h4 id="_2-download-the-nezha-agent" tabindex="-1">2. Download the Nezha Agent <a class="header-anchor" href="#_2-download-the-nezha-agent" aria-label="Permalink to &quot;2. Download the Nezha Agent&quot;">​</a></h4><ol><li><p><strong>Determine the Synology CPU Architecture</strong><br> Use the following command to identify your device&#39;s architecture:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span></span></code></pre></div><p>Common architecture mappings:</p><ul><li><code>x86_64</code> corresponds to <code>amd64</code></li><li><code>armv7l</code> or <code>aarch64</code> corresponds to <code>arm</code></li></ul></li><li><p><strong>Download the Appropriate Nezha Agent Binary</strong><br> Select the correct download link based on your device&#39;s architecture. For example, for <code>amd64</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent.zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/nezhahq/agent/releases/latest/download/nezha-agent_linux_amd64.zip</span></span></code></pre></div></li><li><p><strong>Extract the Files</strong><br> Extract the downloaded archive to a specified directory, such as <code>/opt/nezha</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent.zip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha</span></span></code></pre></div></li><li><p><strong>Grant Execute Permissions</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha/nezha-agent</span></span></code></pre></div></li></ol><hr><h4 id="_3-create-the-configuration-file" tabindex="-1">3. Create the Configuration File <a class="header-anchor" href="#_3-create-the-configuration-file" aria-label="Permalink to &quot;3. Create the Configuration File&quot;">​</a></h4><ol><li><strong>Create and Edit the Configuration File</strong><br> In the <code>/opt/nezha</code> directory, create a <code>config.yml</code> file with the following content:<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">client_secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_agent_secret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_auto_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_command_execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_force_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_nat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_send_query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">insecure_tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ip_report_period</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1800</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">report_delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">data.example.com:8008</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_connection_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_procs_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_gitee_to_upgrade</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_ipv6_country_code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_uuid</span></span></code></pre></div><ul><li><strong>Field Descriptions</strong>: <ul><li><code>server</code>: Replace with your Dashboard address and port, e.g., <code>data.example.com:8008</code>.</li><li><code>client_secret</code>: Replace with the <code>agentsecretkey</code> from the Dashboard&#39;s configuration file, typically located at <code>/opt/nezha/dashboard/data/config.yaml</code>.</li><li><code>uuid</code>: Generate a unique identifier for this Agent using the <code>uuidgen</code> command:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uuidgen</span></span></code></pre></div></li></ul></li><li><strong>Save the File</strong>: Save the file to <code>/opt/nezha/config.yml</code>.</li></ul></li></ol><hr><h4 id="_4-create-a-systemd-service-file" tabindex="-1">4. Create a systemd Service File <a class="header-anchor" href="#_4-create-a-systemd-service-file" aria-label="Permalink to &quot;4. Create a systemd Service File&quot;">​</a></h4><ol><li><p><strong>Create the Service File</strong><br> In the <code>/etc/systemd/system/</code> directory, create a <code>nezha-agent.service</code> file:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/nezha-agent.service</span></span></code></pre></div></li><li><p><strong>Add the Following Content</strong>:</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=Nezha Agent</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">After</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=simple</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=root</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=root</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/opt/nezha/nezha-agent -c /opt/nezha/config.yml</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=always</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RestartSec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=multi-user.target</span></span></code></pre></div></li><li><p><strong>Save the File and Reload Service Configuration</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre></div></li></ol><hr><h4 id="_5-start-the-agent" tabindex="-1">5. Start the Agent <a class="header-anchor" href="#_5-start-the-agent" aria-label="Permalink to &quot;5. Start the Agent&quot;">​</a></h4><ol><li><p><strong>Start the Service</strong><br> Use the following command to start the Agent:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div></li><li><p><strong>Enable the Service to Start on Boot</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div></li><li><p><strong>Check Service Status</strong><br> Ensure the Agent is running correctly:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div></li></ol><hr><h4 id="_6-verify-agent-connection" tabindex="-1">6. Verify Agent Connection <a class="header-anchor" href="#_6-verify-agent-connection" aria-label="Permalink to &quot;6. Verify Agent Connection&quot;">​</a></h4><ol><li>Log in to the Dashboard and check if a new device has come online.</li><li>Ensure the Agent is running smoothly without any error logs.</li></ol></details><hr><h3 id="manually-installing-the-agent-on-windows" tabindex="-1">Manually Installing the Agent on Windows <a class="header-anchor" href="#manually-installing-the-agent-on-windows" aria-label="Permalink to &quot;Manually Installing the Agent on Windows&quot;">​</a></h3><details><summary>Click to Expand/Collapse</summary><p>In addition to the one-click script, Windows systems can also install the Agent by downloading the corresponding binary files and manually configuring them. Follow the steps below:</p><hr><h4 id="_1-preparation-1" tabindex="-1">1. Preparation <a class="header-anchor" href="#_1-preparation-1" aria-label="Permalink to &quot;1. Preparation&quot;">​</a></h4><ol><li><p><strong>Ensure Administrator Privileges</strong><br> Log in to the Windows system using an administrator account.</p></li><li><p><strong>Install Necessary Tools</strong></p><ul><li>Ensure you have a decompression tool installed, such as <code>7-Zip</code> or <code>WinRAR</code>.</li></ul></li></ol><hr><h4 id="_2-download-the-nezha-agent-1" tabindex="-1">2. Download the Nezha Agent <a class="header-anchor" href="#_2-download-the-nezha-agent-1" aria-label="Permalink to &quot;2. Download the Nezha Agent&quot;">​</a></h4><ol><li><p><strong>Confirm System Architecture</strong></p><ul><li>Windows systems are generally <code>amd64</code> architecture, so download the corresponding binary.</li></ul></li><li><p><strong>Download the Nezha Agent Files</strong></p><ul><li>Visit the <a href="https://github.com/nezhahq/agent/releases" target="_blank" rel="noreferrer">Nezha Agent Releases</a> page and download the version suitable for <code>Windows</code>, for example:<div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>nezha-agent_windows_amd64.zip</span></span></code></pre></div></li></ul></li><li><p><strong>Extract the Files</strong></p><ul><li>Extract the downloaded archive to a designated directory, such as <code>C:\\nezha</code>.</li></ul></li></ol><hr><h4 id="_3-create-the-configuration-file-1" tabindex="-1">3. Create the Configuration File <a class="header-anchor" href="#_3-create-the-configuration-file-1" aria-label="Permalink to &quot;3. Create the Configuration File&quot;">​</a></h4><ol><li><strong>Create and Edit the Configuration File</strong><br> In the extracted directory, create a <code>config.yml</code> file with the following content:<div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">client_secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_agent_secret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_auto_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_command_execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_force_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_nat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_send_query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">insecure_tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ip_report_period</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1800</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">report_delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">data.example.com:8008</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_connection_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_procs_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_gitee_to_upgrade</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_ipv6_country_code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_uuid</span></span></code></pre></div><ul><li><strong>Field Descriptions</strong>: <ul><li><code>server</code>: Replace with your Dashboard address and port, e.g., <code>data.example.com:8008</code>.</li><li><code>client_secret</code>: Replace with the <code>agentsecretkey</code> from the Dashboard&#39;s configuration file, typically located at <code>/opt/nezha/dashboard/data/config.yaml</code>.</li><li><code>uuid</code>: Generate a unique identifier for this Agent using an online tool.</li></ul></li></ul></li><li><strong>Save the File</strong><br> Save the file as <code>config.yml</code> in the Agent&#39;s directory.</li></ol><hr><h4 id="_4-run-the-agent" tabindex="-1">4. Run the Agent <a class="header-anchor" href="#_4-run-the-agent" aria-label="Permalink to &quot;4. Run the Agent&quot;">​</a></h4><ol><li><p><strong>Run the Agent with Administrator Privileges</strong><br> Open CMD with administrator rights, navigate to the Agent&#39;s directory, and execute the following command:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nezha-agent.exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c config.yml</span></span></code></pre></div></li><li><p><strong>Verify the Connection</strong></p><ul><li>Log in to the Dashboard and check if a new device has come online.</li><li>If there are no error messages in the Agent&#39;s logs, the installation is successful.</li></ul></li></ol><hr><h4 id="_5-configure-the-agent-to-run-as-a-service" tabindex="-1">5. Configure the Agent to Run as a Service <a class="header-anchor" href="#_5-configure-the-agent-to-run-as-a-service" aria-label="Permalink to &quot;5. Configure the Agent to Run as a Service&quot;">​</a></h4><ol><li><p><strong>Install as a Service</strong></p><ul><li>Navigate to the Agent&#39;s directory in CMD and run:<div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nezha-agent.exe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> service install</span></span></code></pre></div></li></ul></li><li><p><strong>Start the Service</strong></p><ul><li>After successful installation, the Agent will automatically start as a service and will run on system boot.</li></ul></li><li><p><strong>Uninstall the Service</strong></p><ul><li>To uninstall the service, run the following command:<div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nezha-agent.exe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> service uninstall</span></span></code></pre></div></li></ul></li></ol></details><hr><h3 id="installing-the-agent-on-openwrt" tabindex="-1">Installing the Agent on OpenWrt <a class="header-anchor" href="#installing-the-agent-on-openwrt" aria-label="Permalink to &quot;Installing the Agent on OpenWrt&quot;">​</a></h3><details><summary>Click to Expand/Collapse</summary><p>OpenWrt is a lightweight Linux distribution. Installing the Nezha Agent on OpenWrt requires manual downloading and configuration. Follow the steps below:</p><hr><h4 id="_1-preparation-2" tabindex="-1">1. Preparation <a class="header-anchor" href="#_1-preparation-2" aria-label="Permalink to &quot;1. Preparation&quot;">​</a></h4><ol><li><p><strong>Ensure Administrator Privileges</strong></p><ul><li>SSH into the OpenWrt device using the <code>root</code> account.</li></ul></li><li><p><strong>Install Necessary Tools</strong></p><ul><li>Update the package list and install required tools:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">opkg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">opkg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unzip</span></span></code></pre></div></li></ul></li></ol><hr><h4 id="_2-download-the-nezha-agent-2" tabindex="-1">2. Download the Nezha Agent <a class="header-anchor" href="#_2-download-the-nezha-agent-2" aria-label="Permalink to &quot;2. Download the Nezha Agent&quot;">​</a></h4><ol><li><p><strong>Determine System Architecture</strong><br> Use the following command to identify the device&#39;s architecture:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span></span></code></pre></div><p>Common architecture mappings:</p><ul><li><code>x86_64</code> corresponds to <code>nezha-agent_linux_amd64.zip</code></li><li><code>arm</code> or <code>aarch64</code> corresponds to <code>nezha-agent_linux_arm.zip</code></li></ul></li><li><p><strong>Download the Appropriate Nezha Agent</strong><br> Replace <code>&lt;arch&gt;</code> with your device&#39;s architecture:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent.zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/nezhahq/agent/releases/latest/download/nezha-agent_linux_</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">arc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.zip</span></span></code></pre></div></li><li><p><strong>Extract the Files</strong><br> Extract the archive to the <code>/etc/nezha</code> directory:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent.zip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha</span></span></code></pre></div></li></ol><hr><h4 id="_3-create-the-configuration-file-2" tabindex="-1">3. Create the Configuration File <a class="header-anchor" href="#_3-create-the-configuration-file-2" aria-label="Permalink to &quot;3. Create the Configuration File&quot;">​</a></h4><ol><li><p><strong>Create the Configuration File</strong><br> Create and edit the <code>/etc/nezha/config.yml</code> file:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/config.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/config.yml</span></span></code></pre></div><p>Add the following content:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">client_secret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_agent_secret</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_auto_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_command_execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_force_update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_nat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disable_send_query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">gpu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">insecure_tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ip_report_period</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1800</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">report_delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">data.example.com:8008</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_connection_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">skip_procs_count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">temperature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">tls</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_gitee_to_upgrade</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">use_ipv6_country_code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_uuid</span></span></code></pre></div></li><li><p><strong>Save the Configuration File</strong><br> Ensure the configuration file is saved at <code>/etc/nezha/config.yml</code>.</p></li></ol><hr><h4 id="_4-run-the-agent-1" tabindex="-1">4. Run the Agent <a class="header-anchor" href="#_4-run-the-agent-1" aria-label="Permalink to &quot;4. Run the Agent&quot;">​</a></h4><ol><li><p><strong>Grant Execute Permissions and Start the Agent</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/nezha/nezha-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/config.yml</span></span></code></pre></div></li><li><p><strong>Verify Agent Connection</strong></p><ul><li>Log in to the Dashboard Admin Panel and check if a new device has come online.</li><li>Ensure the Agent is running correctly.</li></ul></li></ol><hr><h4 id="_5-configure-the-agent-to-start-on-boot" tabindex="-1">5. Configure the Agent to Start on Boot <a class="header-anchor" href="#_5-configure-the-agent-to-start-on-boot" aria-label="Permalink to &quot;5. Configure the Agent to Start on Boot&quot;">​</a></h4><ol><li><p><strong>Create a Service Script</strong><br> Create a service script at <code>/etc/init.d/nezha-service</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/init.d/nezha-service</span></span></code></pre></div></li><li><p><strong>Add the Following Content</strong><br> Replace <code>/etc/nezha/nezha-agent</code> and <code>/etc/nezha/config.yml</code> with the correct paths if different:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh /etc/rc.common</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">99</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">USE_PROCD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    procd_open_instance</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    procd_set_param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/nezha-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/nezha/config.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    procd_set_param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> respawn</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    procd_close_instance</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stop_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    killall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    stop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sleep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    start</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>Grant Execute Permissions</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/init.d/nezha-service</span></span></code></pre></div></li><li><p><strong>Enable and Start the Service</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/nezha-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/nezha-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre></div></li><li><p><strong>Verify Service Status</strong><br> Check if the service is running correctly:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div></li></ol><hr><h4 id="note" tabindex="-1">Note <a class="header-anchor" href="#note" aria-label="Permalink to &quot;Note&quot;">​</a></h4><ul><li><strong>Configuration File Path</strong>: Ensure the paths to the configuration files (e.g., <code>/etc/nezha/config.yml</code>) are correct in the service scripts.</li><li><strong>Service Management</strong>: You can manage the service using the following commands: <ul><li>Manually start the service:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/nezha-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre></div></li><li>Stop the service:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/nezha-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span></span></code></pre></div></li><li>Restart the service:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/init.d/nezha-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span></code></pre></div></li></ul></li><li><strong>Log Troubleshooting</strong>: If the Agent fails to start correctly, check relevant logs using <code>logread</code> to identify issues.</li></ul></details><hr><h2 id="uninstalling-the-agent" tabindex="-1">Uninstalling the Agent <a class="header-anchor" href="#uninstalling-the-agent" aria-label="Permalink to &quot;Uninstalling the Agent&quot;">​</a></h2><p>Uninstalling the Agent involves stopping the service, uninstalling it, and removing related files. Below are the steps for Ubuntu:</p><ol><li><p>Stop and uninstall the service:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha/agent/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./nezha-agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uninstall</span></span></code></pre></div></li><li><p>Remove the Agent folder:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -rf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/nezha/agent/</span></span></code></pre></div></li></ol><p>If multiple services are installed and removing all of them would be necessary, the Agent installation script can be used to simplify the process.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./agent.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uninstall</span></span></code></pre></div><hr><h2 id="reinstall-and-specify-the-agent-s-uuid" tabindex="-1">Reinstall and Specify the Agent&#39;s UUID <a class="header-anchor" href="#reinstall-and-specify-the-agent-s-uuid" aria-label="Permalink to &quot;Reinstall and Specify the Agent&#39;s UUID&quot;">​</a></h2><p>Add the parameter UUID so that the new Agent connection will inherit the existing server records and configurations.</p><h3 id="steps" tabindex="-1">Steps <a class="header-anchor" href="#steps" aria-label="Permalink to &quot;Steps&quot;">​</a></h3><ol><li><p><strong>Copy the Server&#39;s UUID</strong><br> Navigate to the Dashboard, locate the target server, and retrieve its corresponding UUID.</p></li><li><p><strong>Generate the Installation Command with the UUID</strong><br> In the generated installation command, add the parameter <code>NZ_UUID=server_UUID</code>. This ensures that the Agent is correctly bound to the specified server record.</p></li><li><p><strong>Confirm Whether to Uninstall the Old Agent</strong><br> If an Agent is already installed on the server, make sure to uninstall the old Agent to avoid duplicate registrations or conflicts.</p></li></ol><h3 id="example-installation-command" tabindex="-1">Example Installation Command <a class="header-anchor" href="#example-installation-command" aria-label="Permalink to &quot;Example Installation Command&quot;">​</a></h3><p>Below is an example of a complete installation command with the UUID parameter:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/nezhahq/scripts/main/agent/install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> agent.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> agent.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NZ_SERVER=dashboard.example.com:8008</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NZ_TLS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NZ_CLIENT_SECRET=EXAMPLE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NZ_UUID=your_server_uuid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./agent.sh</span></span></code></pre></div><p>Replace <code>your_server_uuid</code> with the actual UUID of the target server.</p>`,38),l=[t];function h(p,o,r,d,k,c){return a(),i("div",null,l)}const y=s(n,[["render",h]]);export{u as __pageData,y as default};
