import{_ as s,c as i,o as a,a4 as e}from"./chunks/framework.BmdFiWrL.js";const u=JSON.parse('{"title":"Agent Startup/Online Troubleshooting Process","description":"","frontmatter":{},"headers":[],"relativePath":"en_US/guide/q2.md","filePath":"en_US/guide/q2.md","lastUpdated":1756917506000}'),t={name:"en_US/guide/q2.md"},n=e(`<h1 id="agent-startup-online-troubleshooting-process" tabindex="-1">Agent Startup/Online Troubleshooting Process <a class="header-anchor" href="#agent-startup-online-troubleshooting-process" aria-label="Permalink to &quot;Agent Startup/Online Troubleshooting Process&quot;">​</a></h1><p>If the Agent fails to go online after starting, follow these steps to identify and resolve the issue:</p><hr><h2 id="_1-check-network-connectivity" tabindex="-1">1. Check Network Connectivity <a class="header-anchor" href="#_1-check-network-connectivity" aria-label="Permalink to &quot;1. Check Network Connectivity&quot;">​</a></h2><p>Use the following command to test if the local machine can connect to the Dashboard server&#39;s communication port:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Domain/I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Communication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Por</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">telnet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Domain/I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Communication</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Por</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h3 id="notes" tabindex="-1">Notes: <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes:&quot;">​</a></h3><ul><li>If communication between the server and the Dashboard server fails: <ul><li>Check inbound/outbound firewall rules on both the local and Dashboard servers.</li><li>Use a port-checking tool like <a href="https://port.ping.pe/" target="_blank" rel="noreferrer">https://port.ping.pe/</a> to verify if the port is open.</li></ul></li></ul><hr><h2 id="_2-check-selinux-status" tabindex="-1">2. Check SELinux Status <a class="header-anchor" href="#_2-check-selinux-status" aria-label="Permalink to &quot;2. Check SELinux Status&quot;">​</a></h2><p>If the network connection is normal but the Agent is still offline, try disabling SELinux:</p><h3 id="steps-to-disable-selinux" tabindex="-1">Steps to Disable SELinux: <a class="header-anchor" href="#steps-to-disable-selinux" aria-label="Permalink to &quot;Steps to Disable SELinux:&quot;">​</a></h3><ul><li>Check the current SELinux status:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sestatus</span></span></code></pre></div></li><li>Temporarily disable SELinux (no restart required):<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setenforce</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div></li><li>Permanently disable SELinux: Edit the <code>/etc/selinux/config</code> file and change <code>SELINUX=enforcing</code> to:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SELINUX</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">disabled</span></span></code></pre></div>Then restart the system.</li></ul><p><a href="https://www.google.com/search?q=disable+SELINUX" target="_blank" rel="noreferrer">How to Disable SELinux?</a></p><hr><h2 id="_3-view-agent-logs" tabindex="-1">3. View Agent Logs <a class="header-anchor" href="#_3-view-agent-logs" aria-label="Permalink to &quot;3. View Agent Logs&quot;">​</a></h2><p>Enable debug mode in the configuration file. Check the Agent&#39;s running status and logs using the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span></span></code></pre></div><p>Inspect the logs for error messages to pinpoint the cause.</p><hr><h2 id="_4-check-grpc-service-communication" tabindex="-1">4. Check gRPC Service Communication <a class="header-anchor" href="#_4-check-grpc-service-communication" aria-label="Permalink to &quot;4. Check gRPC Service Communication&quot;">​</a></h2><p>Verify if the Agent can successfully connect to the gRPC service:</p><h3 id="use-the-following-command-to-check-the-grpc-service-path" tabindex="-1">Use the following command to check the gRPC service path: <a class="header-anchor" href="#use-the-following-command-to-check-the-grpc-service-path" aria-label="Permalink to &quot;Use the following command to check the gRPC service path:&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Domai</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Por</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/proto.NezhaService/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type:application/grpc&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><h3 id="example-of-a-normal-response" tabindex="-1">Example of a Normal Response: <a class="header-anchor" href="#example-of-a-normal-response" aria-label="Permalink to &quot;Example of a Normal Response:&quot;">​</a></h3><div class="language-plain vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt; HTTP/2 200</span></span>
<span class="line"><span>&lt; content-type: application/grpc</span></span>
<span class="line"><span>&lt;</span></span>
<span class="line"><span>&lt; grpc-message: unknown method  for service proto.NezhaService</span></span>
<span class="line"><span>&lt; grpc-status: 12</span></span></code></pre></div><h3 id="key-information" tabindex="-1">Key Information: <a class="header-anchor" href="#key-information" aria-label="Permalink to &quot;Key Information:&quot;">​</a></h3><ol><li><strong><code>content-type</code> should be <code>application/grpc</code></strong>: <ul><li>If not, it indicates that the gRPC service connection is not functioning correctly.</li></ul></li><li><strong>Presence of <code>grpc-message</code> error details</strong>: <ul><li>A typical response includes <code>unknown method for service proto.NezhaService</code>.</li></ul></li></ol><h3 id="if-the-check-fails" tabindex="-1">If the Check Fails: <a class="header-anchor" href="#if-the-check-fails" aria-label="Permalink to &quot;If the Check Fails:&quot;">​</a></h3><ul><li>Review reverse proxy configurations and ensure traffic routes correctly to the Dashboard server&#39;s gRPC service.</li></ul>`,30),l=[n];function h(o,r,p,c,k,d){return a(),i("div",null,l)}const F=s(t,[["render",h]]);export{u as __pageData,F as default};
