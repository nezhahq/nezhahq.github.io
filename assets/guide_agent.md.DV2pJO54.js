import{_ as s,c as i,o as a,a4 as n}from"./chunks/framework.BmdFiWrL.js";const o=JSON.parse('{"title":"å®‰è£… Agent","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/agent.md","filePath":"guide/agent.md","lastUpdated":1720074734000}'),t={name:"guide/agent.md"},l=n(`<h1 id="å®‰è£…-agent" tabindex="-1">å®‰è£… Agent <a class="header-anchor" href="#å®‰è£…-agent" aria-label="Permalink to &quot;å®‰è£… Agent&quot;">â€‹</a></h1><p><strong>å“ªå’ç›‘æ§çš„è¢«æ§ç«¯æœåŠ¡è¢«ç§°ä¸º Agentï¼Œæœ¬æ–‡æ¡£å°†ä»‹ç»å¦‚ä½•åœ¨è¢«æ§ç«¯æœåŠ¡å™¨ä¸Šå®‰è£… Agentï¼Œå¹¶ä¸ Dashboard è¿æ¥ã€‚</strong></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Agent äºŒè¿›åˆ¶æ–‡ä»¶ä»“åº“åœ°å€ä¸ºï¼š<a href="https://github.com/nezhahq/agent/releases" target="_blank" rel="noreferrer">https://github.com/nezhahq/agent/releases</a></p></div><h2 id="ä¸€é”®å®‰è£…-agent" tabindex="-1">ä¸€é”®å®‰è£… Agent <a class="header-anchor" href="#ä¸€é”®å®‰è£…-agent" aria-label="Permalink to &quot;ä¸€é”®å®‰è£… Agent&quot;">â€‹</a></h2><p>å“ªå’ç›‘æ§æ”¯æŒåœ¨ Windows å’Œ Linux ä¸Šä¸€é”®å®‰è£… Agentã€‚éµå¾ªæœ¬æ–‡æ¡£çš„æ­¥éª¤ï¼Œä½ å¯ä»¥å¾ˆè½»æ¾åœ°åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²å®ƒã€‚</p><h3 id="å‡†å¤‡å·¥ä½œ" tabindex="-1">å‡†å¤‡å·¥ä½œ <a class="header-anchor" href="#å‡†å¤‡å·¥ä½œ" aria-label="Permalink to &quot;å‡†å¤‡å·¥ä½œ&quot;">â€‹</a></h3><p>ä½ éœ€è¦æå‰åœ¨ç®¡ç†é¢æ¿ä¸­è®¾ç½®å¥½é€šä¿¡åŸŸåï¼Œæ­¤åŸŸåä¸å¯ä»¥æ¥å…¥ CDNã€‚æœ¬æ–‡æ¡£ä»¥ç¤ºä¾‹é€šä¿¡åŸŸå â€œdata.example.comâ€ ä¸ºä¾‹ã€‚<br> è¿›å…¥åå°ç®¡ç†é¢æ¿ï¼Œè½¬åˆ°â€œè®¾ç½®â€é¡µï¼Œåœ¨â€œæœªæ¥å…¥ CDN çš„é¢æ¿æœåŠ¡å™¨åŸŸå/IPâ€é¡¹ä¸­å¡«å…¥é€šä¿¡åŸŸåï¼Œç„¶åç‚¹å‡»&quot;ä¿å­˜&quot;ã€‚</p><h3 id="åœ¨-linux-ä¸­ä¸€é”®å®‰è£…-ubuntuã€debianã€centos" tabindex="-1">åœ¨ Linux ä¸­ä¸€é”®å®‰è£… (Ubuntuã€Debianã€CentOS) <a class="header-anchor" href="#åœ¨-linux-ä¸­ä¸€é”®å®‰è£…-ubuntuã€debianã€centos" aria-label="Permalink to &quot;åœ¨ Linux ä¸­ä¸€é”®å®‰è£… (Ubuntuã€Debianã€CentOS)&quot;">â€‹</a></h3><ol><li>é¦–å…ˆåœ¨ç®¡ç†é¢æ¿ä¸­æ·»åŠ ä¸€å°æœåŠ¡å™¨ã€‚</li><li>ç‚¹å‡»æ–°æ·»åŠ çš„æœåŠ¡å™¨æ—çš„ç»¿è‰² Linux å›¾æ ‡æŒ‰é’®ï¼Œå¤åˆ¶ä¸€é”®å®‰è£…å‘½ä»¤ã€‚</li><li>åœ¨è¢«æ§ç«¯æœåŠ¡å™¨ä¸­è¿è¡Œå¤åˆ¶çš„ä¸€é”®å®‰è£…å‘½ä»¤ï¼Œç­‰å¾…å®‰è£…å®Œæˆåè¿”å›åˆ° Dashboard ä¸»é¡µæŸ¥çœ‹æœåŠ¡å™¨æ˜¯å¦ä¸Šçº¿ã€‚</li></ol><h3 id="åœ¨-windows-ä¸­ä¸€é”®å®‰è£…" tabindex="-1">åœ¨ Windows ä¸­ä¸€é”®å®‰è£… <a class="header-anchor" href="#åœ¨-windows-ä¸­ä¸€é”®å®‰è£…" aria-label="Permalink to &quot;åœ¨ Windows ä¸­ä¸€é”®å®‰è£…&quot;">â€‹</a></h3><ol><li>é¦–å…ˆåœ¨ç®¡ç†é¢æ¿ä¸­æ·»åŠ ä¸€å°æœåŠ¡å™¨ã€‚</li><li>ç‚¹å‡»æ–°æ·»åŠ çš„æœåŠ¡å™¨æ—çš„ç»¿è‰² Windows å›¾æ ‡æŒ‰é’®ï¼Œå¤åˆ¶ä¸€é”®å®‰è£…å‘½ä»¤ã€‚</li><li>è¿›å…¥ Windows æœåŠ¡å™¨ï¼Œè¿è¡Œ PowerShellï¼Œåœ¨ PowerShell ä¸­è¿è¡Œå¤åˆ¶çš„å®‰è£…å‘½ä»¤ã€‚</li><li>å¦‚é‡åˆ°ç¡®è®¤ã€Œæ‰§è¡Œç­–ç•¥å˜æ›´ã€è¯·é€‰æ‹© Yã€‚</li><li>ç­‰å¾…å®‰è£…å®Œæˆåè¿”å› Dashboard ä¸»é¡µæŸ¥çœ‹æœåŠ¡å™¨æ˜¯å¦ä¸Šçº¿ã€‚</li></ol><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>å¦‚æœåœ¨ PowerShell ä¸­è¿è¡Œä¸€é”®å®‰è£…å‘½ä»¤æ—¶é‡åˆ°é”™è¯¯ï¼Œè¯·å°è¯•ä¸‹æ–¹çš„<strong>åœ¨ Windows ä¸­æ‰‹åŠ¨å®‰è£… Agent</strong>ã€‚</p></div><h2 id="å…¶ä»–æ–¹å¼å®‰è£…-agent" tabindex="-1">å…¶ä»–æ–¹å¼å®‰è£… Agent <a class="header-anchor" href="#å…¶ä»–æ–¹å¼å®‰è£…-agent" aria-label="Permalink to &quot;å…¶ä»–æ–¹å¼å®‰è£… Agent&quot;">â€‹</a></h2><h3 id="åœ¨-linux-ä¸­å®‰è£…-agent-ubuntuã€debianã€centos" tabindex="-1">åœ¨ Linux ä¸­å®‰è£… Agent (Ubuntuã€Debianã€CentOS) <a class="header-anchor" href="#åœ¨-linux-ä¸­å®‰è£…-agent-ubuntuã€debianã€centos" aria-label="Permalink to &quot;åœ¨ Linux ä¸­å®‰è£… Agent (Ubuntuã€Debianã€CentOS)&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><ol><li>é¦–å…ˆåœ¨ç®¡ç†é¢æ¿ä¸­æ·»åŠ ä¸€å°æœåŠ¡å™¨ã€‚</li><li>åœ¨è¢«æ§æœåŠ¡å™¨ä¸­ï¼Œè¿è¡Œè„šæœ¬ï¼ˆä½äºä¸­å›½å¤§é™†çš„æœåŠ¡å™¨è¯·ä½¿ç”¨é•œåƒï¼‰ï¼š</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/naiba/nezha/master/script/install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./nezha.sh</span></span></code></pre></div><p>å¦‚æœä½ çš„è¢«æ§æœåŠ¡å™¨ä½äºä¸­å›½å¤§é™†ï¼Œå¯ä»¥ä½¿ç”¨é•œåƒï¼š</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://gitee.com/naibahq/nezha/raw/master/script/install.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CN=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./nezha.sh</span></span></code></pre></div><ol start="3"><li>é€‰æ‹©â€œå®‰è£…ç›‘æ§ Agentâ€ã€‚</li><li>è¾“å…¥é€šä¿¡åŸŸåï¼Œå¦‚ï¼šâ€data.example.comâ€œã€‚</li><li>è¾“å…¥é¢æ¿é€šä¿¡ç«¯å£ï¼ˆgRPC ç«¯å£ï¼‰ï¼Œé»˜è®¤ä¸º 5555ã€‚</li><li>è¾“å…¥ Agent å¯†é’¥ï¼ŒAgent å¯†é’¥åœ¨ç®¡ç†é¢æ¿ä¸­æ·»åŠ æœåŠ¡å™¨æ—¶ç”Ÿæˆï¼Œå¯ä»¥åœ¨ç®¡ç†é¢æ¿ä¸­çš„â€œæœåŠ¡å™¨â€é¡µä¸­æ‰¾åˆ°ã€‚</li><li>ç­‰å¾…å®‰è£…å®Œæˆåè¿”å› Dashboard ä¸»é¡µæŸ¥çœ‹æœåŠ¡å™¨æ˜¯å¦ä¸Šçº¿ã€‚</li></ol></details><h3 id="åœ¨å…¶ä»–-linux-å‘è¡Œç‰ˆ-å¦‚-alpine-ä½¿ç”¨-openrc-ä¸­å®‰è£…-agent" tabindex="-1">åœ¨å…¶ä»– Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Alpine ä½¿ç”¨ Openrcï¼‰ä¸­å®‰è£… Agent <a class="header-anchor" href="#åœ¨å…¶ä»–-linux-å‘è¡Œç‰ˆ-å¦‚-alpine-ä½¿ç”¨-openrc-ä¸­å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨å…¶ä»– Linux å‘è¡Œç‰ˆï¼ˆå¦‚ Alpine ä½¿ç”¨ Openrcï¼‰ä¸­å®‰è£… Agent&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><p>æœ¬èŠ‚å†…å®¹ç”± <a href="https://github.com/unknwon0054" target="_blank" rel="noreferrer">unknown0054</a> è´¡çŒ®ã€‚</p><ol><li>ä¿®æ”¹ SERVERã€SECRETã€TLSï¼Œç„¶ååœ¨ shell ä¸­æ‰§è¡Œï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/etc/init.d/nezha-agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">#!/sbin/openrc-run</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SERVER=&quot;&quot; # Dashboard åœ°å€ ip:port</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SECRET=&quot;&quot; # SECRET</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TLS=&quot;&quot; # æ˜¯å¦å¯ç”¨ TLSï¼Œæ˜¯ &quot;--tls&quot; ï¼Œå¦ç•™ç©º</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NZ_BASE_PATH=&quot;/opt/nezha&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">NZ_AGENT_PATH=&quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NZ_BASE_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/agent&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pidfile=&quot;/run/\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RC_SVCNAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.pid&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">command=&quot;/opt/nezha/agent/nezha-agent&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">command_args=&quot;-s \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} -p \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SECRET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TLS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">command_background=true</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">depend() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  need net</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">checkconfig() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  GITHUB_URL=&quot;github.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  if [ ! -f &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NZ_AGENT_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/nezha-agent&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;x86_64&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;amd64&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    elif [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;i386\\|i686&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;386&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    elif [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;aarch64\\|armv8b\\|armv8l&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;arm64&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    elif [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;arm&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;arm&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    elif [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s390x&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;s390x&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    elif [[ $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uname</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;riscv64&#39;) != &quot;&quot; ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      os_arch=&quot;riscv64&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    local version=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://api.github.com/repos/nezhahq/agent/releases/latest&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;tag_name&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> head</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;:&quot; &#39;{print $2}&#39; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/\\&quot;//g;s/,//g;s/ //g&#39;)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [ ! -n &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      version=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://fastly.jsdelivr.net/gh/nezhahq/agent/&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;option\\.value&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&#39;&quot; &#39;{print $2}&#39; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/nezhahq\\/agent@/v/g&#39;)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [ ! -n &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      version=$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://gcore.jsdelivr.net/gh/nezhahq/agent/&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;option\\.value&quot; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -F</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&#39;&quot; &#39;{print $2}&#39; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;s/nezhahq\\/agent@/v/g&#39;)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [ ! -n &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      echo -e &quot;è·å–ç‰ˆæœ¬å·å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœ¬æœºèƒ½å¦é“¾æ¥ https://api.github.com/repos/nezhahq/agent/releases/latest&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return 0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    else</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      echo -e &quot;å½“å‰æœ€æ–°ç‰ˆæœ¬ä¸º: \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    wget -t 2 -T 10 -O nezha-agent_linux_\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os_arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.zip https://\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GITHUB_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/nezhahq/agent/releases/download/\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/nezha-agent_linux_\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os_arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.zip &gt;/dev/null 2&gt;&amp;1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    if [[ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> != 0 ]]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      echo -e &quot;Release ä¸‹è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœ¬æœºèƒ½å¦è¿æ¥ \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GITHUB_URL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return 0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    mkdir -p </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$NZ_AGENT_PATH</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    chmod 755 -R </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$NZ_AGENT_PATH</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    unzip -qo nezha-agent_linux_\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os_arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.zip &amp;&amp; mv nezha-agent </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$NZ_AGENT_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &amp;&amp; rm -rf nezha-agent_linux_\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">os_arch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.zip README.md</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  if [ ! -x &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NZ_AGENT_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/nezha-agent&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    chmod +x \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NZ_AGENT_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}/nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">start_pre() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  if [ &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RC_CMD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot; != &quot;restart&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    checkconfig || return </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$?</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  fi</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span></code></pre></div><ol start="2"><li>å¢åŠ è¿è¡Œæƒé™</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/init.d/nezha-agent</span></span></code></pre></div><ol start="3"><li>è¿è¡Œ Nezha-Agent</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rc-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span></span></code></pre></div><ol start="4"><li>æ·»åŠ å¼€æœºè‡ªå¯åŠ¨</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rc-update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div></details><h3 id="åœ¨-windows-ä¸­æ‰‹åŠ¨å®‰è£…-agent" tabindex="-1">åœ¨ Windows ä¸­æ‰‹åŠ¨å®‰è£… Agent <a class="header-anchor" href="#åœ¨-windows-ä¸­æ‰‹åŠ¨å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨ Windows ä¸­æ‰‹åŠ¨å®‰è£… Agent&quot;">â€‹</a></h3><ul><li>è¯·å‚è€ƒç¤¾åŒºæ–‡ç« ï¼š<br><a href="https://nyko.me/2020/12/13/nezha-windows-client.html" target="_blank" rel="noreferrer">å“ªå’æ¢é’ˆ - Windows å®¢æˆ·ç«¯å®‰è£…</a></li></ul><h3 id="åœ¨ç¾¤æ™–-dsm-ä¸­å®‰è£…-agent" tabindex="-1">åœ¨ç¾¤æ™– DSM ä¸­å®‰è£… Agent <a class="header-anchor" href="#åœ¨ç¾¤æ™–-dsm-ä¸­å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨ç¾¤æ™– DSM ä¸­å®‰è£… Agent&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><ul><li><p>è¯·å‚è€ƒç¤¾åŒºæ–‡ç« ï¼š<br><a href="https://blog.mitsea.com/3929551d08bd4bb0a8baa453e2d92b0c/" target="_blank" rel="noreferrer">ç¾¤æ™– DSM 7.x å®‰è£… å“ªå’ç›‘æ§ Agent</a><br><a href="https://wl.gta5pdx.cn/archives/546/" target="_blank" rel="noreferrer">å“ªå’æ¢é’ˆâ€”â€”ç¾¤æ™–å®¢æˆ·ç«¯ï¼ˆè¢«æ§ç«¯ï¼‰å®‰è£…æ•™ç¨‹</a></p></li><li><p>Systemd å®ç° <em>ä»…é€‚ç”¨äº DSM7</em>:</p></li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Agent è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EXEC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/PATH/TO/nezha-agent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æ—¥å¿—è·¯å¾„åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EXEC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é¢å¤–æ‰§è¡Œå‚æ•°, å¯ç•™ç©º</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ARGS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å“ªå’æœåŠ¡ç«¯ gRPC åœ°å€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HOST_OR_IP:gRPC_PORT&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ä¸Šä¸€æ­¥è·å–çš„ä¸»æœºå¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;APP_SECRET&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># è¿è¡ŒæœåŠ¡çš„ç”¨æˆ·å, *å¼ºçƒˆå»ºè®®ä½¿ç”¨érootç”¨æˆ·æ‰§è¡Œ*</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RUN_USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;nezha&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å†™å…¥åˆ° systemd æœåŠ¡æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EOF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/lib/systemd/system/nezha.service</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Description=Nezha Agent Service</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">After=network.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Type=simple</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ExecStart=/bin/nohup \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EXEC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ARGS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} -s \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} -p \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SECRET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} &amp;&gt;&gt; \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} &amp;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ExecStop=ps -fe |grep nezha-agent|awk &#39;{print </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2}&#39;|xargs kill</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">User=\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RUN_USER</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Restart=on-abort</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># é‡è½½æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># å¯åŠ¨æœåŠ¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æœåŠ¡è‡ªå¯åŠ¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha</span></span></code></pre></div><p>â€¼ï¸ä¿®æ”¹å¯¹åº”ä¿¡æ¯åâ€¼ï¸<br> ä½¿ç”¨ <code>root</code> è´¦å·æ‰§è¡Œä¸Šè¿°å‘½ä»¤å³å¯å®‰è£…å®Œæˆã€‚</p></details><h3 id="åœ¨-macos-ä¸­å®‰è£…-agent" tabindex="-1">åœ¨ macOS ä¸­å®‰è£… Agent <a class="header-anchor" href="#åœ¨-macos-ä¸­å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨ macOS ä¸­å®‰è£… Agent&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><p><em><strong>æœ¬èŠ‚å†…å®¹æ”¹ç¼–è‡ª <a href="https://blog.mitsea.com/e796f93db38d49e4b18df234c6ee75f5" target="_blank" rel="noreferrer">Mitsea Blog</a>ï¼Œæ”¹ç¼–å·²è·å¾—åŸä½œè€…æˆæƒ</strong></em></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>å®‰è£…è¿‡ç¨‹ä¸­å¦‚æç¤ºâ€œmacOS æ— æ³•éªŒè¯æ­¤ appâ€œï¼Œè¯·å‰å¾€ç³»ç»Ÿè®¾ç½®æ‰‹åŠ¨å…è®¸ç¨‹åºè¿è¡Œã€‚</p></div><ol><li>é¦–å…ˆåœ¨ç®¡ç†é¢æ¿ä¸­æ·»åŠ ä¸€å°æœåŠ¡å™¨ã€‚</li><li>å‰å¾€ <a href="https://github.com/nezhahq/agent/releases" target="_blank" rel="noreferrer">Release</a> é¡µä¸‹è½½ Agent äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ ¹æ® CPU æ¶æ„é€‰æ‹©ä¸‹è½½ darwin amd64 è¿˜æ˜¯ arm64 çš„ Agentã€‚<br> å¦‚ Intel CPU ä¸‹è½½ amd64ï¼ŒApple Silicon ä¸‹è½½ arm64 ç‰ˆæœ¬ã€‚ä¸‹è½½å®Œæˆåè§£å‹ Agent äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚è§£å‹åˆ°ä¸‹è½½æ–‡ä»¶å¤¹ã€‚</li><li>æ–°å»ºä¸€ä¸ªåä¸º <code>nezha_agent.plist</code> çš„æ–‡ä»¶å¹¶ä¿å­˜ï¼Œä¿®æ”¹æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</li></ol><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;?</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">xml</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> encoding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UTF-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;!</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DOCTYPE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> plist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">plist</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;KeepAlive&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Label&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;nezha_agent&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Program&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;åœ¨è¿™é‡Œä¿®æ”¹ Agent äºŒè¿›åˆ¶æ–‡ä»¶çš„çš„è·¯å¾„ï¼Œå¦‚ï¼š/Users/123/Downloads/nezha-agent&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ProgramArguments&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;åœ¨è¿™é‡Œä¿®æ”¹ Agent äºŒè¿›åˆ¶æ–‡ä»¶çš„çš„è·¯å¾„ï¼ŒåŒä¸Š&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;--password&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;é€šä¿¡å¯†é’¥ï¼Œå¦‚ï¼š529664783eeb23cc25&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;--server&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;é€šä¿¡ç½‘å€å’Œ gRPC ç«¯å£ï¼Œå¦‚:data.example.com:5555&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;RunAtLoad&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">plist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><ol start="4"><li>åœ¨ Terminal ä¸­ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åŠ è½½ plist æ–‡ä»¶åˆ° launchd é‡Œï¼Œ<strong>æ³¨æ„æ›¿æ¢æ–‡ä»¶è·¯å¾„</strong>ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /Users/123/Desktop/nezha_agent.plist</span></span></code></pre></div><ol start="5"><li>å¯åŠ¨è¿›ç¨‹ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha_agent</span></span></code></pre></div><ol start="6"><li>æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿è¡Œï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha_agent</span></span></code></pre></div><ol start="7"><li>åœæ­¢è¿›ç¨‹å¹¶ç§»é™¤ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha_agent</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launchctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha_agent</span></span></code></pre></div></details><h3 id="åœ¨-macos-ä¸­ä½¿ç”¨-homebrew-å®‰è£…-agent" tabindex="-1">åœ¨ macOS ä¸­ä½¿ç”¨ Homebrew å®‰è£… Agent <a class="header-anchor" href="#åœ¨-macos-ä¸­ä½¿ç”¨-homebrew-å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨ macOS ä¸­ä½¿ç”¨ Homebrew å®‰è£… Agent&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><p><em><strong>æœ¬èŠ‚å†…å®¹æ”¹ç¼–è‡ª <a href="https://blog.mre.red/archives/install_nezha_monitoring_agent_service_with_homebrew" target="_blank" rel="noreferrer">ğŸ¿ï¸æ¾é¼ æ”¶é›†ğŸŒ°</a>ï¼Œæ”¹ç¼–å·²è·å¾—åŸä½œè€…æˆæƒ</strong></em></p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>è¯·åŠ¡å¿…å…ˆæ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå†é€šè¿‡ Homebrew å®‰è£… nezha-agentï¼ å›  Homebrew åœ¨è½¯ä»¶å®‰è£…æ—¶åˆ›å»ºæœåŠ¡æ‰€éœ€ plist æ–‡ä»¶ï¼Œè‹¥å…ˆå®‰è£…å†æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œä¼šå› ç¼ºå°‘å‚æ•°è€Œå¯åŠ¨å¤±è´¥ã€‚</p></div><ol><li>æ·»åŠ ç¯å¢ƒå˜é‡ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;export HOMEBREW_NEZHA_AGENT_PASSWORD=&quot;é€šä¿¡å¯†é’¥ï¼Œåœ¨æœåŠ¡é¡µé¢è·å–&quot;&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.zshrc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;export HOMEBREW_NEZHA_AGENT_SERVER=&quot;ä½ çš„æœåŠ¡å™¨å’Œç«¯å£ï¼Œæ ¼å¼ your.domain:5555 &quot;&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.zshrc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.zshrc</span></span></code></pre></div><ol start="2"><li>å®‰è£… Nezha Agentï¼š</li></ol><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>è¯·æ³¨æ„ï¼Œæ­¤ Homebrew ä»“åº“ç”±ç¬¬ä¸‰æ–¹ç»´æŠ¤ï¼Œä¸å“ªå’ç›‘æ§æ— å…³ã€‚ Nezha é¡¹ç›®ç»„ä¸å¯¹è¯¥ä»“åº“çš„å¯ç”¨æ€§å’Œå®‰å…¨æ€§ç­‰æ–¹é¢ä½œå‡ºèƒŒä¹¦ã€‚åœ¨ä½¿ç”¨å‰ï¼Œè¯·è‡ªè¡Œè¯„ä¼°é£é™©ï¼</p></div><p>ç”±äºæš‚æœªæäº¤åˆ° Homebrew Core å®˜æ–¹åº“ï¼Œæš‚æ—¶æ”¾åœ¨ä¸Šè¿°åšå®¢ä½œè€…å‚ä¸ç»´æŠ¤çš„ <a href="https://github.com/Brewforge/homebrew-chinese" target="_blank" rel="noreferrer">ç¬¬ä¸‰æ–¹ Homebrew ä»“åº“</a> ä¸­ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brewforge/chinese/nezha-agent</span></span></code></pre></div><ol start="3"><li>é€šè¿‡ Homebrew å¯åŠ¨ Nezha Agent æœåŠ¡ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><ol start="4"><li>æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><ol start="5"><li>åœæ­¢æœåŠ¡ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><ol start="6"><li>å¸è½½ Nezha Agentï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><ol start="7"><li>æŠ¥é”™æ—¶å…ˆæ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOMEBREW_NEZHA_AGENT_PASSWORD</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOMEBREW_NEZHA_AGENT_SERVER</span></span></code></pre></div><ol start="8"><li>è‹¥ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®ï¼Œå†å°è¯•é‡è£…ï¼š</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> services</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span></code></pre></div><ol start="9"><li>è‹¥ä»æœªè§£å†³ï¼Œè¯·å‰å¾€ä¸Šè¿° <a href="https://github.com/Brewforge/homebrew-chinese" target="_blank" rel="noreferrer">ç¬¬ä¸‰æ–¹ Homebrew ä»“åº“</a> æäº¤ issueã€‚</li></ol></details><h3 id="åœ¨-openwrt-ä¸­å®‰è£…-agent" tabindex="-1">åœ¨ OpenWRT ä¸­å®‰è£… Agent <a class="header-anchor" href="#åœ¨-openwrt-ä¸­å®‰è£…-agent" aria-label="Permalink to &quot;åœ¨ OpenWRT ä¸­å®‰è£… Agent&quot;">â€‹</a></h3><details><summary>ç‚¹å‡»å±•å¼€/æ”¶èµ·</summary><p><strong>å¦‚ä½•ä¸€æ­¥åˆ°ä½ï¼Œè§£å†³å®‰è£…è¿‡ç¨‹ä¸­çš„ç–‘éš¾æ‚ç—‡ï¼Ÿ</strong></p><ul><li>è¯·å‚è€ƒé¡¹ç›®ï¼š<br><a href="https://github.com/dysf888/NZ-OpenWrt" target="_blank" rel="noreferrer">NZ-OpenWrt</a></li></ul><p><strong>å¦‚ä½•ä½¿æ—§ç‰ˆ OpenWRT/LEDE è‡ªå¯åŠ¨ï¼Ÿ</strong></p><ul><li>è¯·å‚è€ƒé¡¹ç›®ï¼š<br><a href="https://github.com/Erope/openwrt_nezha" target="_blank" rel="noreferrer">å“ªå’ç›‘æ§ For OpenWRT</a></li></ul><p><strong>å¦‚ä½•ä½¿æ–°ç‰ˆ OpenWRT è‡ªå¯åŠ¨ï¼Ÿ è´¡çŒ®è€…ï¼š@è‰¾æ–¯å¾·æ–¯</strong></p><ul><li>é¦–å…ˆåœ¨ release ä¸‹è½½å¯¹åº”çš„äºŒè¿›åˆ¶è§£å‹ zip åŒ…åæ”¾ç½®åˆ° <code>/root</code>ã€‚</li><li>è¿è¡Œ <code>chmod +x /root/nezha-agent</code> èµ‹äºˆæ‰§è¡Œæƒé™ï¼Œç„¶ååˆ›å»º <code>/etc/init.d/nezha-service</code>ï¼š</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/sh /etc/rc.common</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">START</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">99</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">USE_PROCD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> procd_open_instance</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> procd_set_param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/nezha-agent</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> é¢æ¿é€šä¿¡åœ°å€:ç«¯å£</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ç§˜é’¥</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> procd_set_param</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> respawn</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> procd_close_instance</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stop_service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  killall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nezha-agent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> stop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sleep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> start</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>è¿è¡Œ <code>chmod +x /etc/init.d/nezha-service</code> èµ‹äºˆæ‰§è¡Œæƒé™ã€‚</li><li>å¯åŠ¨æœåŠ¡ï¼š <code>/etc/init.d/nezha-service enable &amp;&amp; /etc/init.d/nezha-service start</code></li></ul></details><h2 id="agent-æœ‰-docker-é•œåƒå—" tabindex="-1">Agent æœ‰ Docker é•œåƒå—ï¼Ÿ <a class="header-anchor" href="#agent-æœ‰-docker-é•œåƒå—" aria-label="Permalink to &quot;Agent æœ‰ Docker é•œåƒå—ï¼Ÿ&quot;">â€‹</a></h2><p><strong>Agent ç›®å‰æ²¡æœ‰æ¨å‡º Docker é•œåƒã€‚</strong><br> Agent çš„è®¾è®¡æ€è·¯å’Œ Dashboard ç›¸åï¼ŒDashboard è¦å°½å¯èƒ½ä¸å½±å“å®¿ä¸»æœºå·¥ä½œï¼Œä½† Agent åˆ™éœ€è¦åœ¨å®¿ä¸»æœºä¸­æ‰§è¡Œç›‘æ§æœåŠ¡å’Œè¿è¡Œå‘½ä»¤ã€‚<br> å°† Agent æ”¾å…¥å®¹å™¨ä¸­ç¡®å®å¯ä»¥ç»§ç»­æ‰§è¡Œç›‘æ§ä»»åŠ¡ï¼Œä½† WebShell ç­‰åŠŸèƒ½æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå› æ­¤ä¸æä¾› Docker é•œåƒã€‚</p>`,29),h=[l];function e(p,k,r,g,d,F){return a(),i("div",null,h)}const c=s(t,[["render",e]]);export{o as __pageData,c as default};
